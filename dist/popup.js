import{r as a,u as T,f as D,a as U,P as B,L as G,c as k,j as e,m as M,A as P,C as R,b as z,E as J,g as _,s as W,d as K,e as H}from"./storage.js";function V(){const n=a.useRef(!1);return T(()=>(n.current=!0,()=>{n.current=!1}),[]),n}function Z(){const n=V(),[t,s]=a.useState(0),r=a.useCallback(()=>{n.current&&s(t+1)},[t]);return[a.useCallback(()=>D.postRender(r),[r]),t]}class X extends a.Component{getSnapshotBeforeUpdate(t){const s=this.props.childRef.current;if(s&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=s.offsetHeight||0,r.width=s.offsetWidth||0,r.top=s.offsetTop,r.left=s.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Q({children:n,isPresent:t}){const s=a.useId(),r=a.useRef(null),c=a.useRef({width:0,height:0,top:0,left:0});return a.useInsertionEffect(()=>{const{width:o,height:i,top:l,left:b}=c.current;if(t||!r.current||!o||!i)return;r.current.dataset.motionPopId=s;const p=document.createElement("style");return document.head.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${i}px !important;
            top: ${l}px !important;
            left: ${b}px !important;
          }
        `),()=>{document.head.removeChild(p)}},[t]),a.createElement(X,{isPresent:t,childRef:r,sizeRef:c},a.cloneElement(n,{ref:r}))}const A=({children:n,initial:t,isPresent:s,onExitComplete:r,custom:c,presenceAffectsLayout:o,mode:i})=>{const l=U(Y),b=a.useId(),p=a.useMemo(()=>({id:b,initial:t,isPresent:s,custom:c,onExitComplete:x=>{l.set(x,!0);for(const f of l.values())if(!f)return;r&&r()},register:x=>(l.set(x,!1),()=>l.delete(x))}),o?void 0:[s]);return a.useMemo(()=>{l.forEach((x,f)=>l.set(f,!1))},[s]),a.useEffect(()=>{!s&&!l.size&&r&&r()},[s]),i==="popLayout"&&(n=a.createElement(Q,{isPresent:s},n)),a.createElement(B.Provider,{value:p},n)};function Y(){return new Map}function ee(n){return a.useEffect(()=>()=>n(),[])}const S=n=>n.key||"";function se(n,t){n.forEach(s=>{const r=S(s);t.set(r,s)})}function te(n){const t=[];return a.Children.forEach(n,s=>{a.isValidElement(s)&&t.push(s)}),t}const F=({children:n,custom:t,initial:s=!0,onExitComplete:r,exitBeforeEnter:c,presenceAffectsLayout:o=!0,mode:i="sync"})=>{const l=a.useContext(G).forceRender||Z()[0],b=V(),p=te(n);let x=p;const f=a.useRef(new Map).current,w=a.useRef(x),v=a.useRef(new Map).current,N=a.useRef(!0);if(T(()=>{N.current=!1,se(p,v),w.current=x}),ee(()=>{N.current=!0,v.clear(),f.clear()}),N.current)return a.createElement(a.Fragment,null,x.map(g=>a.createElement(A,{key:S(g),isPresent:!0,initial:s?void 0:!1,presenceAffectsLayout:o,mode:i},g)));x=[...x];const d=w.current.map(S),m=p.map(S),C=d.length;for(let g=0;g<C;g++){const y=d[g];m.indexOf(y)===-1&&!f.has(y)&&f.set(y,void 0)}return i==="wait"&&f.size&&(x=[]),f.forEach((g,y)=>{if(m.indexOf(y)!==-1)return;const E=v.get(y);if(!E)return;const j=d.indexOf(y);let u=g;if(!u){const h=()=>{f.delete(y);const q=Array.from(v.keys()).filter(I=>!m.includes(I));if(q.forEach(I=>v.delete(I)),w.current=p.filter(I=>{const O=S(I);return O===y||q.includes(O)}),!f.size){if(b.current===!1)return;l(),r&&r()}};u=a.createElement(A,{key:S(E),isPresent:!1,onExitComplete:h,custom:t,presenceAffectsLayout:o,mode:i},E),f.set(y,u)}x.splice(j,0,u)}),x=x.map(g=>{const y=g.key;return f.has(y)?g:a.createElement(A,{key:S(g),isPresent:!0,presenceAffectsLayout:o,mode:i},g)}),a.createElement(a.Fragment,null,f.size?x:x.map(g=>a.cloneElement(g)))},ae=k("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),re=k("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),ne=k("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),oe=k("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),ie=k("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),L=k("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),le=k("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),ce=k("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),de=k("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ue=k("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),xe=k("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),me=({onComplete:n})=>{const[t,s]=a.useState(0),[r,c]=a.useState(""),[o,i]=a.useState(""),[l,b]=a.useState(""),[p,x]=a.useState([]),[f,w]=a.useState(!1),[v,N]=a.useState(!1),d=["Bem-vindo","Escolha sua IA","Configure a chave","Escolha o modelo","Teste a conex√£o","Pronto!"],m=()=>{t<d.length-1&&s(t+1)},C=()=>{t>0&&s(t-1)},g=async()=>{if(!(!o||!r)){N(!0);try{const j=await _(r,o);x(j),j.length>0&&!l&&b(j[0])}catch(j){console.error("Erro ao carregar modelos:",j);const u=P.find(h=>h.id===r);u&&(x(u.defaultModels),b(u.defaultModels[0]))}finally{N(!1)}}},y=async()=>{w(!0);try{await new Promise(j=>setTimeout(j,2e3)),await W({selectedProvider:r,apiKey:o,selectedModel:l,isConfigured:!0,hasCompletedOnboarding:!0}),m()}catch{alert("Erro ao testar conex√£o. Verifique sua chave de API.")}finally{w(!1)}},E=()=>{var j;switch(t){case 0:return e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ü§ñ"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Bem-vindo ao Assistente IA Web!"}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:"Automatize tarefas repetitivas na web com intelig√™ncia artificial. Vou te ajudar a configurar tudo em poucos passos simples."}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"O que voc√™ pode fazer:"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:'‚Ä¢ "Fa√ßa uma postagem de bom dia no LinkedIn"'}),e.jsx("li",{children:'‚Ä¢ "Consulte pre√ßos de passagem para S√£o Paulo"'}),e.jsx("li",{children:'‚Ä¢ "Bata meu ponto no sistema da empresa"'}),e.jsx("li",{children:"‚Ä¢ E muito mais!"})]})]})]});case 1:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Escolha seu Provedor de IA"}),e.jsx("p",{className:"text-gray-600",children:"Selecione qual intelig√™ncia artificial voc√™ quer usar"})]}),e.jsx("div",{className:"space-y-3",children:P.map(h=>e.jsx("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${r===h.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>c(h.id),children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("span",{className:"text-2xl",children:h.icon}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:h.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:h.description}),e.jsx("p",{className:"text-xs text-green-600 font-medium",children:h.costInfo})]}),r===h.id&&e.jsx(R,{className:"w-5 h-5 text-blue-500"})]})},h.id))})]});case 2:const u=P.find(h=>h.id===r);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Configure sua Chave de API"}),e.jsxs("p",{className:"text-gray-600",children:["Voc√™ precisa de uma chave para usar ",u==null?void 0:u.name]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(z,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-yellow-800",children:"Como obter sua chave:"}),e.jsxs("ol",{className:"text-sm text-yellow-700 mt-2 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Clique no link abaixo para abrir o site oficial"}),e.jsx("li",{children:"Crie uma conta ou fa√ßa login"}),e.jsx("li",{children:'Procure por "API Keys" ou "Chaves de API"'}),e.jsx("li",{children:"Crie uma nova chave e copie ela"}),e.jsx("li",{children:"Cole a chave no campo abaixo"})]})]})]})}),e.jsxs("a",{href:u==null?void 0:u.setupUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center space-x-2 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsxs("span",{children:["Abrir ",u==null?void 0:u.name]}),e.jsx(J,{className:"w-4 h-4"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:u==null?void 0:u.apiKeyLabel}),e.jsx("input",{type:"password",value:o,onChange:h=>i(h.target.value),placeholder:"Cole sua chave de API aqui...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]});case 3:return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Escolha o Modelo de IA"}),e.jsx("p",{className:"text-gray-600",children:"Selecione qual modelo voc√™ quer usar"})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("button",{onClick:g,disabled:!o||v,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),e.jsx("span",{children:"Carregando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{children:"Carregar Modelos"})]})})}),p.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Modelos Dispon√≠veis:"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:p.map(h=>e.jsx("div",{className:`p-3 border-2 rounded-lg cursor-pointer transition-all ${l===h?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>b(h),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"font-medium text-gray-800",children:h}),l===h&&e.jsx(R,{className:"w-5 h-5 text-blue-500"})]})},h))})]}),p.length===0&&!v&&e.jsx("div",{className:"text-center text-gray-500",children:'Clique em "Carregar Modelos" para ver os modelos dispon√≠veis'})]});case 4:return e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Vamos testar sua configura√ß√£o"}),e.jsx("p",{className:"text-gray-600",children:"Clique no bot√£o abaixo para verificar se tudo est√° funcionando"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Configura√ß√£o Atual:"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Provedor:"})," ",(j=P.find(h=>h.id===r))==null?void 0:j.name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Modelo:"})," ",l]}),e.jsxs("p",{children:[e.jsx("strong",{children:"API Key:"})," ",o?"‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢":"N√£o configurada"]})]})]}),e.jsx("button",{onClick:y,disabled:f||!o||!l,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:f?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),e.jsx("span",{children:"Testando conex√£o..."})]}):"Testar Conex√£o"})]});case 5:return e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üéâ"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Tudo pronto!"}),e.jsx("p",{className:"text-gray-600",children:"Sua extens√£o est√° configurada e pronta para usar. Agora voc√™ pode automatizar suas tarefas web!"}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-green-800 mb-2",children:"Pr√≥ximos passos:"}),e.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ Clique no √≠cone da extens√£o na barra do navegador"}),e.jsx("li",{children:'‚Ä¢ Digite uma instru√ß√£o como "Abra o Gmail"'}),e.jsx("li",{children:"‚Ä¢ Veja a m√°gica acontecer!"})]})]}),e.jsx("button",{onClick:n,className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"Come√ßar a usar"})]});default:return null}};return e.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:d.map((j,u)=>e.jsxs("div",{className:`flex items-center ${u<=t?"text-blue-600":"text-gray-400"}`,children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${u<=t?"bg-blue-600 text-white":"bg-gray-200 text-gray-400"}`,children:u+1}),u<d.length-1&&e.jsx("div",{className:`w-12 h-0.5 mx-2 ${u<t?"bg-blue-600":"bg-gray-200"}`})]},u))}),e.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["Passo ",t+1," de ",d.length,": ",d[t]]})]}),e.jsx(F,{mode:"wait",children:e.jsx(M.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"min-h-[400px] flex flex-col justify-center",children:E()},t)}),t<d.length-1&&t!==4&&e.jsxs("div",{className:"flex justify-between mt-8",children:[e.jsxs("button",{onClick:C,disabled:t===0,className:"flex items-center space-x-2 px-4 py-2 text-gray-600 hover:text-gray-800 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ae,{className:"w-4 h-4"}),e.jsx("span",{children:"Anterior"})]}),e.jsxs("button",{onClick:m,disabled:t===1&&!r||t===2&&!o||t===3&&!l,className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("span",{children:"Pr√≥ximo"}),e.jsx(re,{className:"w-4 h-4"})]})]})]})},he=({steps:n,onComplete:t,onCancel:s})=>{const[r,c]=a.useState(0),[o,i]=a.useState(!1),[l,b]=a.useState(!1),[p,x]=a.useState(new Set),f=async(m,C)=>{try{const[g]=await chrome.tabs.query({active:!0,currentWindow:!0});return await chrome.tabs.sendMessage(g.id,{type:"EXECUTE_STEP",step:m}),x(y=>new Set([...y,C])),await new Promise(y=>setTimeout(y,1e3)),!0}catch(g){return console.error("Erro ao executar passo:",g),!1}},w=async()=>{i(!0),b(!1);for(let m=r;m<n.length&&!l;m++)if(c(m),!await f(n[m],m)){i(!1),alert(`Erro ao executar o passo: ${n[m].description}`);return}i(!1),t()},v=()=>{b(!0),i(!1)},N=()=>{i(!1),b(!1),c(0),x(new Set),s()},d=m=>p.has(m)?e.jsx(R,{className:"w-5 h-5 text-green-500"}):m===r&&o?e.jsx(ne,{className:"w-5 h-5 text-blue-500 animate-pulse"}):e.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Executando Tarefa"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[p.size," de ",n.length," passos conclu√≠dos"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${p.size/n.length*100}%`}})}),e.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2",children:n.map((m,C)=>e.jsxs(M.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:C*.1},className:`flex items-center space-x-3 p-3 rounded-lg ${C===r&&o?"bg-blue-50 border border-blue-200":p.has(C)?"bg-green-50 border border-green-200":"bg-gray-50 border border-gray-200"}`,children:[d(C),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800",children:m.description}),e.jsxs("p",{className:"text-xs text-gray-500",children:[m.action," ",m.target&&`‚Üí ${m.target}`]})]})]},m.id))}),e.jsxs("div",{className:"flex justify-center space-x-3",children:[!o&&!l&&e.jsxs("button",{onClick:w,className:"flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:"Iniciar"})]}),o&&e.jsxs("button",{onClick:v,className:"flex items-center space-x-2 bg-yellow-600 text-white px-4 py-2 rounded-lg hover:bg-yellow-700 transition-colors",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{children:"Pausar"})]}),l&&e.jsxs("button",{onClick:w,className:"flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:"Continuar"})]}),e.jsxs("button",{onClick:N,className:"flex items-center space-x-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(xe,{className:"w-4 h-4"}),e.jsx("span",{children:"Parar"})]})]})]})};class pe{async makeRequest(t){const s=await K();if(!s.isConfigured)throw new Error("IA n√£o configurada. Configure primeiro nas op√ß√µes.");switch(s.selectedProvider){case"openai":return this.callOpenAI(t,s.apiKey,s.selectedModel);case"gemini":return this.callGemini(t,s.apiKey,s.selectedModel);case"ollama":return this.callOllama(t,s.apiKey,s.selectedModel);default:throw new Error("Provedor de IA n√£o suportado")}}async callOpenAI(t,s,r){const c=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({model:r||"gpt-3.5-turbo",messages:[{role:"system",content:'Voc√™ √© um assistente que converte instru√ß√µes em passos de automa√ß√£o web. Responda sempre em JSON com formato: {"steps": [{"action": "navigate|click|type|wait", "target": "seletor ou URL", "value": "texto se necess√°rio", "description": "descri√ß√£o do passo"}], "explanation": "explica√ß√£o do que ser√° feito", "warnings": ["avisos se houver"]}'},{role:"user",content:t}],temperature:.3})});if(!c.ok){const i=await c.text();throw new Error(`Erro na API OpenAI: ${c.status} - ${i}`)}return(await c.json()).choices[0].message.content}async callGemini(t,s,r){const o=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${r||"gemini-pro"}:generateContent?key=${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:`Voc√™ √© um assistente que converte instru√ß√µes em passos de automa√ß√£o web. Responda sempre em JSON com formato: {"steps": [{"action": "navigate|click|type|wait", "target": "seletor ou URL", "value": "texto se necess√°rio", "description": "descri√ß√£o do passo"}], "explanation": "explica√ß√£o do que ser√° feito", "warnings": ["avisos se houver"]}

Instru√ß√£o: ${t}`}]}],generationConfig:{temperature:.3,topK:1,topP:1,maxOutputTokens:2048}})});if(!o.ok){const l=await o.text();throw new Error(`Erro na API Gemini: ${o.status} - ${l}`)}const i=await o.json();if(!i.candidates||!i.candidates[0]||!i.candidates[0].content)throw new Error("Resposta inv√°lida da API Gemini");return i.candidates[0].content.parts[0].text}async callOllama(t,s,r){const c=await fetch(`${s}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:r||"llama2",prompt:`Voc√™ √© um assistente que converte instru√ß√µes em passos de automa√ß√£o web. Responda sempre em JSON com formato: {"steps": [{"action": "navigate|click|type|wait", "target": "seletor ou URL", "value": "texto se necess√°rio", "description": "descri√ß√£o do passo"}], "explanation": "explica√ß√£o do que ser√° feito", "warnings": ["avisos se houver"]}

Instru√ß√£o: ${t}`,stream:!1})});if(!c.ok){const i=await c.text();throw new Error(`Erro no Ollama: ${c.status} - ${i}`)}return(await c.json()).response}async processInstruction(t){try{const s=await this.makeRequest(t);let r=s;const c=s.match(/\{[\s\S]*\}/);c&&(r=c[0]);const o=JSON.parse(r);return{steps:o.steps.map((i,l)=>({id:`step-${l}`,description:i.description,action:i.action,target:i.target,value:i.value,completed:!1})),explanation:o.explanation,warnings:o.warnings||[]}}catch(s){throw console.error("Erro ao processar instru√ß√£o:",s),new Error(`N√£o foi poss√≠vel processar a instru√ß√£o: ${s.message}`)}}}const fe=new pe,ge=()=>{const[n,t]=a.useState(null),[s,r]=a.useState(""),[c,o]=a.useState(!1),[i,l]=a.useState(null),[b,p]=a.useState(!1);a.useEffect(()=>{x()},[]);const x=async()=>{try{const d=await K();t(d),d.hasCompletedOnboarding||p(!0)}catch(d){console.error("Erro ao carregar configura√ß√µes:",d)}},f=async()=>{if(!(!s.trim()||c)){o(!0);try{const d=await fe.processInstruction(s);l(d),r("")}catch{alert("Erro ao processar instru√ß√£o. Verifique sua configura√ß√£o.")}finally{o(!1)}}},w=()=>{l(null)},v=()=>{l(null)},N=()=>{chrome.runtime.openOptionsPage()};return b?e.jsx(me,{onComplete:()=>{p(!1),x()}}):n!=null&&n.isConfigured?e.jsx("div",{className:"w-full h-full bg-white",children:e.jsx(F,{mode:"wait",children:i?e.jsx(M.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"p-4",children:e.jsx(he,{steps:i.steps,onComplete:w,onCancel:v})},"task-executor"):e.jsxs(M.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ue,{className:"w-6 h-6 text-blue-600"}),e.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"Assistente IA"})]}),e.jsx("button",{onClick:N,className:"p-2 text-gray-500 hover:text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",children:e.jsx(de,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Exemplos r√°pidos:"}),e.jsx("div",{className:"grid grid-cols-1 gap-2",children:["Abra o Gmail e verifique novos emails","Fa√ßa uma postagem no LinkedIn","Consulte o clima para hoje"].map((d,m)=>e.jsx("button",{onClick:()=>r(d),className:"text-left text-xs text-blue-600 hover:text-blue-800 bg-blue-50 hover:bg-blue-100 p-2 rounded transition-colors",children:d},m))})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"O que voc√™ quer que eu fa√ßa?"}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:s,onChange:d=>r(d.target.value),placeholder:"Ex: Fa√ßa uma postagem de bom dia no meu LinkedIn",className:"w-full p-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",rows:3,onKeyDown:d=>{d.key==="Enter"&&!d.shiftKey&&(d.preventDefault(),f())}}),e.jsx("button",{onClick:f,disabled:!s.trim()||c,className:"absolute bottom-2 right-2 p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?e.jsx(oe,{className:"w-4 h-4 animate-spin"}):e.jsx(ce,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-800 mb-2",children:"üí° Dicas:"}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[e.jsx("li",{children:"‚Ä¢ Seja espec√≠fico sobre o que quer fazer"}),e.jsx("li",{children:'‚Ä¢ Mencione o site se necess√°rio (ex: "no LinkedIn")'}),e.jsx("li",{children:"‚Ä¢ Use linguagem natural e simples"})]})]})]},"main-interface")})}):e.jsxs("div",{className:"p-6 text-center space-y-4",children:[e.jsx(z,{className:"w-12 h-12 text-yellow-500 mx-auto"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Configura√ß√£o Necess√°ria"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure sua IA antes de usar a extens√£o"}),e.jsx("button",{onClick:N,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Abrir Configura√ß√µes"})]})},$=document.getElementById("popup-root");$&&H($).render(e.jsx(ge,{}));
